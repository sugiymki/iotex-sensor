#!/usr/bin/python
#
# Title: script for getting data from SGP30
#
# Author: Ko-ichiro Sugiyama
#
# This program is based on the following script: 
# https://pypi.org/project/sgp30/

from smbus2 import SMBusWrapper
from sgp30 import Sgp30
import time

with SMBusWrapper(1) as bus:
    sgp=Sgp30(bus,baseline_filename="/tmp/mySGP30_baseline") 
    print("resetting all i2c devices")
    sgp.i2c_geral_call() #WARNING: Will reset any device on teh i2cbus that listens for general call
    print(sgp.read_features())
    print(sgp.read_serial())
    sgp.init_sgp()
    print(sgp.read_measurements())
    print("the SGP30 takes at least 15 seconds to warm up, 12 hours before the readigs become really stable")
    print(sgp.read_measurements())
    time.sleep(40)
    print(sgp.read_measurements())
    time.sleep(1)
    print(sgp.read_measurements())
    time.sleep(1)
    print(sgp.read_measurements())
    time.sleep(1)
    print(sgp.read_measurements())    
    time.sleep(1)
    print(sgp.read_measurements())
    time.sleep(1)
    print(sgp.read_measurements())
    time.sleep(1)
    print(sgp.read_measurements())
    time.sleep(1)
    print(sgp.read_selftest())    
    time.sleep(1)
    print(sgp.read_selftest())    
